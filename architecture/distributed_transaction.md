## 分布式事务解决方案

### RPC调用失败

一个任务包含 2 个操作，A 操作更新本地事务，B 操作 RPC 调用， 如果 A 成功了，B 失败了（timeout），导致数据不一致，一般是如何解决该问题的？

* 接口重试，捕获异常后进行重试，要求接口幂等
* 状态变迁 + 定时任务， 如果中间状态没有完成，通过定时任务扫描补偿，策略是重试等幂等性处理


### MQ消息发送失败

一个任务包含 2 个操作，A 操作更新本地事务，B 发送 MQ， 如果 A 成功了，B 失败了（消息处理失败），导致数据不一致，一般是如何解决该问题的？

* 本地消息表 + 定时任务，发送消息前，写一条本地消息，待发送状态；发送成功后更新该消息状态，通过定时任务扫描进行补偿，例如重发
* 如果采用事务消息再执行本地事务的模式，性能会比较差

