### 酒店需求补充

--

#### 入住消息超时处理

**1 需求来源**

用户从入住酒店，到规则引擎接收到入住事件，可能会因以下情况导致消息超时：

* 网络状况不稳定导致消息发送延时
* MQ服务异常或压力过大导致消息积压

目前规则规则引擎系统未做超时处理，可能导致以下问题：

* 用户入住很久后才收到消息，依然对空调进行温度控制


**2 解决方案**

1. 酒店服务在原消息的基础上增加时间戳字段，标记消息产生的时间
2. 大数据服务需要转发该时间戳到规则引擎
3. 规则引擎根据当前时间和消息产生时间判断该消息是否超时
4. 如果消息超时则丢弃该消息

**3 协议**

* timestamp 入住时间，**ms**级别
* 超时时间：**3min**, 暂时不能动态修改

**4 版本计划**

* 暂定下周一发布
* 参与方：酒店服务/大数据服务/规则引擎/测试

