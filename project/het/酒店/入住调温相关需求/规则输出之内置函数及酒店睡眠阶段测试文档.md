## 规则输出之内置函数及酒店流程（睡眠阶段）测试文档


#### 通过老专家系统后台添加

添加动作 -> 选择设备 -> 选择设备功能参数 -> 设置参数值

**内置函数参数值格式：关键字 “FUNCTION:” + 函数名**

例如获取用户的温度偏好，函数为temperatureAdjust

```
FUNCTION:temperatureAdjust

```
---

#### 酒店用户睡眠阶段调温规则联动流程

#### 测试前提
酒店入住的用户，存在用户画像数据
#### 规则配置

条件：睡眠监测器，选择首次深睡

动作: 设备动作，通过智慧盒子/空调盒子添加红外空调

设备功能: 温度，值为 FUNCTION:temperatureAdjust:Q416（函数，函数名，参数）
特别说明：不同测试环境的输入参数（空调盒子/智慧盒子检测的室内温度tb_condition.condition_key）以当前环境为准
#### 规则启用

用户匹配并开启场景

#### 触发逻辑

睡眠后台向场景系统发送带子状态/首次深睡

条件因子： sleepStatus



#### 执行逻辑

规则计算，如果规则满足，则执行动作，动作是内置函数，调用函数返回温度值，下发空调温度控制指令


```
//函数执行步骤

根据用户id去用户画像库获取温度偏好和其他信息 -- 调用知识图谱获取最适合温度 -- 不能超过温度上下限

```




